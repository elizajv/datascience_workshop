This contains codes for my Data Science Workshop capstone project:

```{r}

#### Load packages
library(jsonlite)
library(plyr)
library(stringr)
library(tidyr)
library(dplyr)
library(gdata)
library(scales)
library(ggplot2)

#### Extract data from Reliefweb API
rwjobsraw1 <- fromJSON("http://api.reliefweb.int/v1/jobs?offset=0&limit=1000&preset=analysis&filter[field]=date.created&filter[value][from]=2015-05-01T00:00:00%2B00:00&filter[value][to]=2015-05-31T00:00:00%2B00:00&&fields[include][]title&fields[include][]=body&fields[include][]=theme.name&fields[include][]=country.name&fields[include][]=type.name&fields[include][]=experience.name&fields[include][]=career_categories.name&fields[include][]=date.created&fields[include][]=id&fields[include][]=source.name&fields[include][]=source.type.name")

#### Assign data set to "rwjobs1" and review column names
rwjobs1 <- rwjobsraw1$data$fields
colnames(rwjobs1)
View(rwjobs1)

#### Unlist nested lists
rwjobs1$theme <- llply(rwjobs1$theme, unlist)
rwjobs1$type <- llply(rwjobs1$type, unlist)
rwjobs1$experience <- llply(rwjobs1$experience, unlist)
rwjobs1$career_categories <- llply(rwjobs1$career_categories, unlist)
rwjobs1$country <- llply(rwjobs1$country, unlist)
rwjobs1$date <- llply(rwjobs1$date, unlist)
rwjobs1$source <- llply(rwjobs1$source, unlist)

#### Clean dataset by removing unneccesary characters and splitting strings 
rwjobs1$source <- gsub("\\c\\(", "", rwjobs1$source)
rwjobs1$source <- gsub("\"", "", rwjobs1$source)
rwjobs1$source <- gsub("\\)", "", rwjobs1$source)
source_split <- strsplit(rwjobs1$source, split = ",")
select_el <- function(x, index) {x[index]}
org_name <- lapply(source_split, select_el, index = 1)
org_type <- lapply(source_split, select_el, index = 2)
rwjobs1$organization <- as.character(org_name)
rwjobs1$organization_type <- as.character(org_type)
rwjobs1$source <- NULL

rwjobs1$theme <- gsub("\\c\\(", "", rwjobs1$theme)
rwjobs1$theme <- gsub("\"", "", rwjobs1$theme)
rwjobs1$theme <- gsub("\\)", "", rwjobs1$theme)

rwjobs1$career_categories <- gsub("\\c\\(", "", rwjobs1$career_categories)
rwjobs1$career_categories <- gsub("\"", "", rwjobs1$career_categories)
rwjobs1$career_categories <- gsub("\\)", "", rwjobs1$career_categories)

rwjobs1$date <- gsub("\\c\\(", "", rwjobs1$date)
rwjobs1$date <- gsub("\"", "", rwjobs1$date)
date_split <- strsplit(rwjobs1$date, split = "-")
select_el <- function(x, index) {x[index]}
year <- lapply(date_split, select_el, index = 1) 
month <- lapply(date_split, select_el, index = 2) 
day <- lapply(date_split, select_el, index = 3) 
rwjobs1$year <- as.character(year)
rwjobs1$month <- as.character(month)
rwjobs1$date <- NULL
rwjobs1$year[1]
rwjobs1$year[1000]
rwjobs1$month[1]
rwjobs1$month[1000]

#### Save dataset into a csv file, amending the csv file name depending on the batch of data extracted
rwjobs1 <- data.frame(lapply(rwjobs1, as.character), stringsAsFactors=FALSE)
write.csv(rwjobs1, "rwjobsMay115.csv")

#### Combine cleaned dataset
```{r}
rwjobsJun116 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun116.csv", 1)
rwjobsJun216 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun216.csv", 1)
rwjobsMay116 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay1.csv", 1)
rwjobsMay216 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay2.csv", 1)
rwjobsMay316 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay3.csv", 1)
rwjobsApr116 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr1.csv", 1)
rwjobsApr216 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr2.csv", 1)
rwjobsApr316 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr3.csv", 1)
rwjobsMar116 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar1.csv", 1)
rwjobsMar216 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar2.csv", 1)
rwjobsMar316 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar3.csv", 1)
rwjobsFeb116 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb1.csv", 1)
rwjobsFeb216 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb2.csv", 1)
rwjobsFeb316 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb3.csv", 1)
rwjobsJan116 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan1.csv", 1)
rwjobsJan216 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan2.csv", 1)
rwjobsJan316 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan3.csv", 1)
rwj2016 <- rbind(rwjobsJan116, rwjobsJan216, rwjobsJan316, rwjobsFeb116, rwjobsFeb216, rwjobsFeb316, rwjobsMar116, rwjobsMar216, rwjobsMar316, rwjobsApr116, rwjobsApr216, rwjobsApr316, rwjobsMay116, rwjobsMay216, rwjobsMay316, rwjobsJun116, rwjobsJun216)
write.csv(rwj2016, "rwj2016.csv")

rwjobsJan115 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan115.csv", 1)
rwjobsJan215 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan215.csv", 1)
rwjobsJan315 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan315.csv", 1)
rwjobsFeb115 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb115.csv", 1)
rwjobsFeb215 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb215.csv", 1)
rwjobsFeb315 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb315.csv", 1)
rwjobsMar115 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar115.csv", 1)
rwjobsMar215 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar215.csv", 1)
rwjobsMar315 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar315.csv", 1)
rwjobsApr115 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr115.csv", 1)
rwjobsApr215 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr215.csv", 1)
rwjobsApr315 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr315.csv", 1)
rwjobsMay115 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay115.csv", 1)
rwjobsMay215 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay215.csv", 1)
rwjobsMay315 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay315.csv", 1)
rwjobsJun115 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun115.csv", 1)
rwjobsJun215 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun215.csv", 1)
rwjobsJun315 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun315.csv", 1)
rwjobsJul115 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul115.csv", 1)
rwjobsJul215 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul215.csv", 1)
rwjobsJul315 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul315.csv", 1)
rwjobsAug115 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug115.csv", 1)
rwjobsAug215 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug215.csv", 1)
rwjobsAug315 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug315.csv", 1)
rwjobsSep115 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep115.csv", 1)
rwjobsSep215 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep215.csv", 1)
rwjobsSep315 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep315.csv", 1)
rwjobsOct115 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct115.csv", 1)
rwjobsOct215 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct215.csv", 1)
rwjobsOct315 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct315.csv", 1)
rwjobsNov115 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov115.csv", 1)
rwjobsNov215 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov215.csv", 1)
rwjobsNov315 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov315.csv", 1)
rwjobsDec115 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec115.csv", 1)
rwjobsDec215 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec215.csv", 1)
rwjobsDec315 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec315.csv", 1)
rwj2015 <- rbind(rwjobsJan115, rwjobsJan215, rwjobsJan315, rwjobsFeb115, rwjobsFeb215, rwjobsFeb315, rwjobsMar115, rwjobsMar215, rwjobsMar315, rwjobsApr115, rwjobsApr215, rwjobsApr315, rwjobsMay115, rwjobsMay215, rwjobsMay315, rwjobsJun115, rwjobsJun215, rwjobsJun315, rwjobsJul115, rwjobsJul215, rwjobsJul315, rwjobsAug115, rwjobsAug215, rwjobsAug315, rwjobsSep115, rwjobsSep215, rwjobsSep315, rwjobsOct115, rwjobsOct215, rwjobsOct315, rwjobsNov115, rwjobsNov215, rwjobsNov315, rwjobsDec115, rwjobsDec215, rwjobsDec315)
write.csv(rwj2015, "rwj2015.csv")

rwjobsJan114 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan114.csv", 1)
rwjobsJan214 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan214.csv", 1)
rwjobsFeb114 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb114.csv", 1)
rwjobsFeb214 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb214.csv", 1)
rwjobsMar114 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar114.csv", 1)
rwjobsMar214 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar214.csv", 1)
rwjobsMar314 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar314.csv", 1)
rwjobsApr114 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr114.csv", 1)
rwjobsApr214 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr214.csv", 1)
rwjobsApr314 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr314.csv", 1)
rwjobsMay114 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay114.csv", 1)
rwjobsMay214 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay214.csv", 1)
rwjobsMay314 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay314.csv", 1)
rwjobsJun114 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun114.csv", 1)
rwjobsJun214 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun214.csv", 1)
rwjobsJun314 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun314.csv", 1)
rwjobsJul114 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul114.csv", 1)
rwjobsJul214 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul214.csv", 1)
rwjobsJul314 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul314.csv", 1)
rwjobsAug114 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug114.csv", 1)
rwjobsAug214 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug214.csv", 1)
rwjobsAug314 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug314.csv", 1)
rwjobsSep114 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep114.csv", 1)
rwjobsSep214 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep214.csv", 1)
rwjobsSep314 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep314.csv", 1)
rwjobsOct114 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct114.csv", 1)
rwjobsOct214 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct214.csv", 1)
rwjobsOct314 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct314.csv", 1)
rwjobsNov114 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov114.csv", 1)
rwjobsNov214 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov214.csv", 1)
rwjobsNov314 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov314.csv", 1)
rwjobsDec114 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec114.csv", 1)
rwjobsDec214 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec214.csv", 1)
rwjobsDec314 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec314.csv", 1)
rwj2014 <- rbind(rwjobsJan114, rwjobsJan214, rwjobsFeb114, rwjobsFeb214, rwjobsMar114, rwjobsMar214, rwjobsMar314, rwjobsApr114, rwjobsApr214, rwjobsApr314, rwjobsMay114, rwjobsMay214, rwjobsMay314, rwjobsJun114, rwjobsJun214, rwjobsJun314, rwjobsJul114, rwjobsJul214, rwjobsJul314, rwjobsAug114, rwjobsAug214, rwjobsAug314, rwjobsSep114, rwjobsSep214, rwjobsSep314, rwjobsOct114, rwjobsOct214, rwjobsOct314, rwjobsNov114, rwjobsNov214, rwjobsNov314, rwjobsDec114, rwjobsDec214, rwjobsDec314)
write.csv(rwj2014, "rwj2014.csv")

rwjobsJan113 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan113.csv", 1)
rwjobsJan213 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan213.csv", 1)
rwjobsFeb113 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb113.csv", 1)
rwjobsFeb213 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb213.csv", 1)
rwjobsMar113 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar113.csv", 1)
rwjobsMar213 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar213.csv", 1)
rwjobsApr113 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr113.csv", 1)
rwjobsApr213 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr213.csv", 1)
rwjobsMay113 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay113.csv", 1)
rwjobsMay213 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay213.csv", 1)
rwjobsMay313 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay313.csv", 1)
rwjobsJun113 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun113.csv", 1)
rwjobsJun213 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun213.csv", 1)
rwjobsJul113 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul113.csv", 1)
rwjobsJul213 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul213.csv", 1)
rwjobsJul313 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul313.csv", 1)
rwjobsAug113 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug113.csv", 1)
rwjobsAug213 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug213.csv", 1)
rwjobsSep113 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep113.csv", 1)
rwjobsSep213 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep213.csv", 1)
rwjobsOct113 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct113.csv", 1)
rwjobsOct213 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct213.csv", 1)
rwjobsNov113 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov113.csv", 1)
rwjobsNov213 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov213.csv", 1)
rwjobsDec113 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec113.csv", 1)
rwjobsDec213 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec213.csv", 1)
rwj2013 <- rbind(rwjobsJan113, rwjobsJan213, rwjobsFeb113, rwjobsFeb213, rwjobsMar113, rwjobsMar213, rwjobsApr113, rwjobsApr213, rwjobsMay113, rwjobsMay213, rwjobsMay313, rwjobsJun113, rwjobsJun213, rwjobsJul113, rwjobsJul213, rwjobsJul313, rwjobsAug113, rwjobsAug213, rwjobsSep113, rwjobsSep213, rwjobsOct113, rwjobsOct213, rwjobsNov113, rwjobsNov213, rwjobsDec113, rwjobsDec213)
write.csv(rwj2013, "rwj2013.csv")

rwjobsJan112 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan112.csv", 1)
rwjobsJan212 <- read.csv("C:/Users/elizajv/Documents/rwjobsJan212.csv", 1)
rwjobsFeb112 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb112.csv", 1)
rwjobsFeb212 <- read.csv("C:/Users/elizajv/Documents/rwjobsFeb212.csv", 1)
rwjobsMar112 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar112.csv", 1)
rwjobsMar212 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar212.csv", 1)
rwjobsApr112 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr112.csv", 1)
rwjobsApr212 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr212.csv", 1)
rwjobsMay112 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay112.csv", 1)
rwjobsMay212 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay212.csv", 1)
rwjobsJun112 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun112.csv", 1)
rwjobsJun212 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun212.csv", 1)
rwjobsJul112 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul112.csv", 1)
rwjobsJul212 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul212.csv", 1)
rwjobsAug112 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug112.csv", 1)
rwjobsAug212 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug212.csv", 1)
rwjobsSep112 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep112.csv", 1)
rwjobsSep212 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep212.csv", 1)
rwjobsOct112 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct112.csv", 1)
rwjobsOct212 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct212.csv", 1)
rwjobsNov112 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov112.csv", 1)
rwjobsNov212 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov212.csv", 1)
rwjobsDec112 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec112.csv", 1)
rwjobsDec212 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec212.csv", 1)
rwj2012 <- rbind(rwjobsJan112, rwjobsJan212, rwjobsFeb112, rwjobsFeb212, rwjobsMar112, rwjobsMar212, rwjobsApr112, rwjobsApr212, rwjobsMay112, rwjobsMay212,rwjobsJun112, rwjobsJun212, rwjobsJul112, rwjobsJul212, rwjobsAug112, rwjobsAug212, rwjobsSep112, rwjobsSep212, rwjobsOct112, rwjobsOct212, rwjobsNov112, rwjobsNov212, rwjobsDec112, rwjobsDec212)
write.csv(rwj2012, "rwj2012.csv")

rwjobsMar111 <- read.csv("C:/Users/elizajv/Documents/rwjobsMar111.csv", 1)
rwjobsApr111 <- read.csv("C:/Users/elizajv/Documents/rwjobsApr111.csv", 1)
rwjobsMay111 <- read.csv("C:/Users/elizajv/Documents/rwjobsMay111.csv", 1)
rwjobsJun111 <- read.csv("C:/Users/elizajv/Documents/rwjobsJun111.csv", 1)
rwjobsJul111 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul111.csv", 1)
rwjobsJul211 <- read.csv("C:/Users/elizajv/Documents/rwjobsJul211.csv", 1)
rwjobsAug111 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug111.csv", 1)
rwjobsAug211 <- read.csv("C:/Users/elizajv/Documents/rwjobsAug211.csv", 1)
rwjobsSep111 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep111.csv", 1)
rwjobsSep211 <- read.csv("C:/Users/elizajv/Documents/rwjobsSep211.csv", 1)
rwjobsOct111 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct111.csv", 1)
rwjobsOct211 <- read.csv("C:/Users/elizajv/Documents/rwjobsOct211.csv", 1)
rwjobsNov111 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov111.csv", 1)
rwjobsNov211 <- read.csv("C:/Users/elizajv/Documents/rwjobsNov211.csv", 1)
rwjobsDec111 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec111.csv", 1)
rwjobsDec211 <- read.csv("C:/Users/elizajv/Documents/rwjobsDec211.csv", 1)
rwj2011 <- rbind(rwjobsMar111, rwjobsApr111, rwjobsMay111, rwjobsJun111, rwjobsJul111, rwjobsJul211, rwjobsAug111, rwjobsAug211, rwjobsSep111, rwjobsSep211, rwjobsOct111, rwjobsOct211, rwjobsNov111, rwjobsNov211, rwjobsDec111, rwjobsDec211)
write.csv(rwj2011, "rwj2011.csv")
rwjAll <- rbind(rwj2011, rwj2012, rwj2013, rwj2014, rwj2015, rwj2016)
write.csv(rwjAll, "rwjAll.csv")

#### Remove duplicate values and unnecessary column
rwjAll <- rwjAll[!duplicated(rwjAll), ]
rwjAll$X <- NULL
View(rwjAll)

#### Create columns based on language keywords in the "body" and "country_name" columns, with the latter based on which donor countries have made English an official language
rwjAll$English1 <- as.vector(c(NA * 117598))
rwjAll$English1 <- str_match(rwjAll$body, "English")
rwjAll$English1 <- ifelse(rwjAll$English1 == "English", 1, 0)
rwjAll$English1 <- unmatrix(rwjAll$English1)

rwjAll$English2 <- as.vector(c(NA * 117598))
rwjAll$English2 <- str_match(rwjAll$country, "United States")
rwjAll$English2 <- ifelse(rwjAll$English2 == "United States", 1, 0)
rwjAll$English2 <- unmatrix(rwjAll$English2)
for (i in 1:length(rwjAll$English1))
if (!is.na(rwjAll$English1[i])) rwjAll$English2[i]=NA

rwjAll$English3 <- as.vector(c(NA * 117598))
rwjAll$English3 <- str_match(rwjAll$country, "United Kingdom")
rwjAll$English3 <- ifelse(rwjAll$English3 == "United Kingdom", 1, 0)
rwjAll$English3 <- unmatrix(rwjAll$English3)
for (i in 1:length(rwjAll$English1))
if (!is.na(rwjAll$English1[i])) rwjAll$English3[i]=NA

rwjAll$English4 <- as.vector(c(NA * 117598))
rwjAll$English4 <- str_match(rwjAll$country, "Ireland")
rwjAll$English4 <- ifelse(rwjAll$English4 == "Ireland", 1, 0)
rwjAll$English4 <- unmatrix(rwjAll$English4)
for (i in 1:length(rwjAll$English1))
if (!is.na(rwjAll$English1[i])) rwjAll$English4[i]=NA
for (i in 1:length(rwjAll$English3))
if (!is.na(rwjAll$English3[i])) rwjAll$English4[i]=NA

rwjAll$English5 <- as.vector(c(NA * 117598))
rwjAll$English5 <- str_match(rwjAll$country, "Canada")
rwjAll$English5 <- ifelse(rwjAll$English5 == "Canada", 1, 0)
rwjAll$English5 <- unmatrix(rwjAll$English5)
for (i in 1:length(rwjAll$English1))
if (!is.na(rwjAll$English1[i])) rwjAll$English5[i]=NA

rwjAll$English6 <- as.vector(c(NA * 117598))
rwjAll$English6 <- str_match(rwjAll$country, "Australia")
rwjAll$English6 <- ifelse(rwjAll$English6 == "Australia", 1, 0)
rwjAll$English6 <- unmatrix(rwjAll$English6)
for (i in 1:length(rwjAll$English1))
if (!is.na(rwjAll$English1[i])) rwjAll$English6[i]=NA

rwjAll$English_total <- rowSums(rwjAll[, 13:18], na.rm = TRUE)

rwjAll$French <- as.vector(c(NA * 117598))
rwjAll$French <- str_match(rwjAll$body, "French")
rwjAll$French <- ifelse(rwjAll$French == "French", 1, 0)
rwjAll$French <- unmatrix(rwjAll$French)

rwjAll$Arabic <- as.vector(c(NA * 117598))
rwjAll$Arabic <- str_match(rwjAll$body, "Arabic") 
rwjAll$Arabic <- ifelse(rwjAll$Arabic=="Arabic", 1, 0)
rwjAll$Arabic <- unmatrix(rwjAll$Arabic)

rwjAll$Spanish <- as.vector(c(NA * 117598))
rwjAll$Spanish <- str_match(rwjAll$body, "Spanish") 
rwjAll$Spanish <- ifelse(rwjAll$Spanish=="Spanish", 1, 0)
rwjAll$Spanish <- unmatrix(rwjAll$Spanish)

rwjAll$Russian <- as.vector(c(NA * 117598))
rwjAll$Russian <- str_match(rwjAll$body, "Russian") 
rwjAll$Russian <- ifelse(rwjAll$Russian=="Russian", 1, 0)
rwjAll$Russian <- unmatrix(rwjAll$Russian)

rwjAll$Chinese <- as.vector(c(NA * 117598))
rwjAll$Chinese <- str_match(rwjAll$body, "Chinese") 
rwjAll$Chinese <- ifelse(rwjAll$Chinese=="Chinese", 1, 0)
rwjAll$Chinese <- unmatrix(rwjAll$Chinese)

rwjAll$Portuguese <- as.vector(c(NA * 117598))
rwjAll$Portuguese <- str_match(rwjAll$body, "Portuguese") 
rwjAll$Portuguese <- ifelse(rwjAll$Portuguese=="Portuguese", 1, 0)
rwjAll$Portuguese <- unmatrix(rwjAll$Portuguese)

rwjAll$local <- as.vector(c(NA * 117598))
rwjAll$local <- str_match(rwjAll$body, "local language") 
rwjAll$local <- ifelse(rwjAll$local=="local language", 1, 0)
rwjAll$local <- unmatrix(rwjAll$local)

rwjAll_bil <- filter(rwjAll, English_total == 1)
View(rwjAll_bil)

rwjAll_bil$EF <- rwjAll_bil$English_total + rwjAll_bil$French
rwjAll_bil$EA <- rwjAll_bil$English_total + rwjAll_bil$Arabic
rwjAll_bil$ES <- rwjAll_bil$English_total + rwjAll_bil$Spanish
rwjAll_bil$ER <- rwjAll_bil$English_total + rwjAll_bil$Russian
rwjAll_bil$EC <- rwjAll_bil$English_total + rwjAll_bil$Chinese
rwjAll_bil$EP <- rwjAll_bil$English_total + rwjAll_bil$Portuguese
rwjAll_bil$EL <- rwjAll_bil$English_total + rwjAll_bil$local

#### Determine overall bilingual frequencies

rwjAll_bil16 <- filter(rwjAll_bil, year == 2016) 
View(rwjAll_bil16)
total_EF_16 <- sum(rwjAll_bil16$EF, na.rm = TRUE) / 2
EF_percent_16 <- total_EF_16 / nrow(rwjAll_bil16)
total_EA_16 <- sum(rwjAll_bil16$EA, na.rm = TRUE) / 2 
EA_percent_16 <- total_EA_16 / nrow(rwjAll_bil16)
total_ES_16 <- sum(rwjAll_bil16$ES, na.rm = TRUE) / 2 
ES_percent_16 <- total_ES_16 / nrow(rwjAll_bil16)
total_ER_16 <- sum(rwjAll_bil16$ER, na.rm = TRUE) / 2 
ER_percent_16 <- total_ER_16 / nrow(rwjAll_bil16)
total_EC_16 <- sum(rwjAll_bil16$EC, na.rm = TRUE) / 2 
EC_percent_16 <- total_EC_16 / nrow(rwjAll_bil16)
total_EP_16 <- sum(rwjAll_bil16$EP, na.rm = TRUE) / 2 
EP_percent_16 <- total_EP_16 / nrow(rwjAll_bil16)
total_EL_16 <- sum(rwjAll_bil16$EL, na.rm = TRUE) / 2 
EL_percent_16 <- total_EL_16 / nrow(rwjAll_bil16)

rwjAll_bil15 <- filter(rwjAll_bil, year == 2015) 
View(rwjAll_bil15)
total_EF_15 <- sum(rwjAll_bil15$EF, na.rm = TRUE) / 2
EF_percent_15 <- total_EF_15 / nrow(rwjAll_bil15)
total_EA_15 <- sum(rwjAll_bil15$EA, na.rm = TRUE) / 2 
EA_percent_15 <- total_EA_15 / nrow(rwjAll_bil15)
total_ES_15 <- sum(rwjAll_bil15$ES, na.rm = TRUE) / 2 
ES_percent_15 <- total_ES_15 / nrow(rwjAll_bil15)
total_ER_15 <- sum(rwjAll_bil15$ER, na.rm = TRUE) / 2 
ER_percent_15 <- total_ER_15 / nrow(rwjAll_bil15)
total_EC_15 <- sum(rwjAll_bil15$EC, na.rm = TRUE) / 2 
EC_percent_15 <- total_EC_15 / nrow(rwjAll_bil15)
total_EP_15 <- sum(rwjAll_bil15$EP, na.rm = TRUE) / 2 
EP_percent_15 <- total_EP_15 / nrow(rwjAll_bil15)
total_EL_15 <- sum(rwjAll_bil15$EL, na.rm = TRUE) / 2 
EL_percent_15 <- total_EL_15 / nrow(rwjAll_bil15)

rwjAll_bil14 <- filter(rwjAll_bil, year == 2014) 
View(rwjAll_bil14)
total_EF_14 <- sum(rwjAll_bil14$EF, na.rm = TRUE) / 2
EF_percent_14 <- total_EF_14 / nrow(rwjAll_bil14)
total_EA_14 <- sum(rwjAll_bil14$EA, na.rm = TRUE) / 2 
EA_percent_14 <- total_EA_14 / nrow(rwjAll_bil14)
total_ES_14 <- sum(rwjAll_bil14$ES, na.rm = TRUE) / 2 
ES_percent_14 <- total_ES_14 / nrow(rwjAll_bil14)
total_ER_14 <- sum(rwjAll_bil14$ER, na.rm = TRUE) / 2 
ER_percent_14 <- total_ER_14 / nrow(rwjAll_bil14)
total_EC_14 <- sum(rwjAll_bil14$EC, na.rm = TRUE) / 2 
EC_percent_14 <- total_EC_14 / nrow(rwjAll_bil14)
total_EP_14 <- sum(rwjAll_bil14$EP, na.rm = TRUE) / 2 
EP_percent_14 <- total_EP_14 / nrow(rwjAll_bil14)
total_EL_14 <- sum(rwjAll_bil14$EL, na.rm = TRUE) / 2 
EL_percent_14 <- total_EL_14 / nrow(rwjAll_bil14)

rwjAll_bil13 <- filter(rwjAll_bil, year == 2013) 
View(rwjAll_bil13)
total_EF_13 <- sum(rwjAll_bil13$EF, na.rm = TRUE) / 2
EF_percent_13 <- total_EF_13 / nrow(rwjAll_bil13)
total_EA_13 <- sum(rwjAll_bil13$EA, na.rm = TRUE) / 2 
EA_percent_13 <- total_EA_13 / nrow(rwjAll_bil13)
total_ES_13 <- sum(rwjAll_bil13$ES, na.rm = TRUE) / 2 
ES_percent_13 <- total_ES_13 / nrow(rwjAll_bil13)
total_ER_13 <- sum(rwjAll_bil13$ER, na.rm = TRUE) / 2 
ER_percent_13 <- total_ER_13 / nrow(rwjAll_bil13)
total_EC_13 <- sum(rwjAll_bil13$EC, na.rm = TRUE) / 2 
EC_percent_13 <- total_EC_13 / nrow(rwjAll_bil13)
total_EP_13 <- sum(rwjAll_bil13$EP, na.rm = TRUE) / 2 
EP_percent_13 <- total_EP_13 / nrow(rwjAll_bil13)
total_EL_13 <- sum(rwjAll_bil13$EL, na.rm = TRUE) / 2 
EL_percent_13 <- total_EL_13 / nrow(rwjAll_bil13)

rwjAll_bil12 <- filter(rwjAll_bil, year == 2012) 
View(rwjAll_bil12)
total_EF_12 <- sum(rwjAll_bil12$EF, na.rm = TRUE) / 2
EF_percent_12 <- total_EF_12 / nrow(rwjAll_bil12)
total_EA_12 <- sum(rwjAll_bil12$EA, na.rm = TRUE) / 2 
EA_percent_12 <- total_EA_12 / nrow(rwjAll_bil12)
total_ES_12 <- sum(rwjAll_bil12$ES, na.rm = TRUE) / 2 
ES_percent_12 <- total_ES_12 / nrow(rwjAll_bil12)
total_ER_12 <- sum(rwjAll_bil12$ER, na.rm = TRUE) / 2 
ER_percent_12 <- total_ER_12 / nrow(rwjAll_bil12)
total_EC_12 <- sum(rwjAll_bil12$EC, na.rm = TRUE) / 2 
EC_percent_12 <- total_EC_12 / nrow(rwjAll_bil12)
total_EP_12 <- sum(rwjAll_bil12$EP, na.rm = TRUE) / 2 
EP_percent_12 <- total_EP_12 / nrow(rwjAll_bil12)
total_EL_12 <- sum(rwjAll_bil12$EL, na.rm = TRUE) / 2 
EL_percent_12 <- total_EL_12 / nrow(rwjAll_bil12)

rwjAll_bil11 <- filter(rwjAll_bil, year == 2011) 
View(rwjAll_bil11)
total_EF_11 <- sum(rwjAll_bil11$EF, na.rm = TRUE) / 2
EF_percent_11 <- total_EF_11 / nrow(rwjAll_bil11)
total_EA_11 <- sum(rwjAll_bil11$EA, na.rm = TRUE) / 2 
EA_percent_11 <- total_EA_11 / nrow(rwjAll_bil11)
total_ES_11 <- sum(rwjAll_bil11$ES, na.rm = TRUE) / 2 
ES_percent_11 <- total_ES_11 / nrow(rwjAll_bil11)
total_ER_11 <- sum(rwjAll_bil11$ER, na.rm = TRUE) / 2 
ER_percent_11 <- total_ER_11 / nrow(rwjAll_bil11)
total_EC_11 <- sum(rwjAll_bil11$EC, na.rm = TRUE) / 2 
EC_percent_11 <- total_EC_11 / nrow(rwjAll_bil11)
total_EP_11 <- sum(rwjAll_bil11$EP, na.rm = TRUE) / 2 
EP_percent_11 <- total_EP_11 / nrow(rwjAll_bil11)
total_EL_11 <- sum(rwjAll_bil11$EL, na.rm = TRUE) / 2 
EL_percent_11 <- total_EL_11 / nrow(rwjAll_bil11)


#### Create dataset showing bilingual comparisons 
year <- c(2011, 2012, 2013, 2014, 2015, 2016)
English_French <- c(EF_percent_11, EF_percent_12, EF_percent_13, EF_percent_14, EF_percent_15, EF_percent_16) 
English_Arabic <- c(EA_percent_11, EA_percent_12, EA_percent_13, EA_percent_14, EA_percent_15, EA_percent_16)     
English_Spanish <- c(ES_percent_11, ES_percent_12, ES_percent_13, ES_percent_14, ES_percent_15, ES_percent_16)
English_Russian <- c(ER_percent_11, ER_percent_12, ER_percent_13, ER_percent_14, ER_percent_15, ER_percent_16)
English_Chinese <- c(EC_percent_11, EC_percent_12, EC_percent_13, EC_percent_14, EC_percent_15, EC_percent_16)
English_Portuguese <- c(EP_percent_11, EP_percent_12, EP_percent_13, EP_percent_14, EP_percent_15, EP_percent_16)  
English_local <- c(EL_percent_11, EL_percent_12, EL_percent_13, EL_percent_14, EL_percent_15, EL_percent_16)

bi_lang_pct <- cbind(year, English_French, English_Arabic, English_Spanish, English_Russian, English_Chinese, English_Portuguese, English_local)
bi_lang_pct <- as.data.frame(bi_lang_pct)
bi_lang_pct$English_French <- bi_lang_pct$English_French * 100
bi_lang_pct$English_French <- round(bi_lang_pct$English_French, digits = 2)
bi_lang_pct$English_Arabic <- bi_lang_pct$English_Arabic * 100
bi_lang_pct$English_Arabic <- round(bi_lang_pct$English_Arabic, digits = 2)
bi_lang_pct$English_Spanish <- bi_lang_pct$English_Spanish * 100
bi_lang_pct$English_Spanish <- round(bi_lang_pct$English_Spanish, digits = 2)
bi_lang_pct$English_Russian <- bi_lang_pct$English_Russian * 100
bi_lang_pct$English_Russian <- round(bi_lang_pct$English_Russian, digits = 2)
bi_lang_pct$English_Chinese <- bi_lang_pct$English_Chinese * 100
bi_lang_pct$English_Chinese <- round(bi_lang_pct$English_Chinese, digits = 2)
bi_lang_pct$English_Portuguese <- bi_lang_pct$English_Portuguese * 100
bi_lang_pct$English_Portuguese <- round(bi_lang_pct$English_Portuguese, digits = 2)
bi_lang_pct$English_local <- bi_lang_pct$English_local * 100
bi_lang_pct$English_local <- round(bi_lang_pct$English_local, digits = 2)
write.csv(bi_lang_pct, "bi_lang_pct.csv")

#### Reshape and plot data frame 
bil_comb <- bi_lang_pct %>% gather(bilingual_combination, percentage, 2:8) 
View(bil_comb) 

ggplot(bil_comb, aes(x = year, y = percentage, color = bilingual_combination)) + geom_point() + geom_line(size = 2)

#### Perform one sample t-tests
EF_tTest <- t.test(bi_lang_pct$English_French, mu=25)
EA_tTest <- t.test(bi_lang_pct$English_Arabic, mu=15)
ES_tTest <- t.test(bi_lang_pct$English_Spanish, mu=15)
EC_tTest <- t.test(bi_lang_pct$English_Chinese, mu=3)
ER_tTest <- t.test(bi_lang_pct$English_Russian, mu=2)
EP_tTest <- t.test(bi_lang_pct$English_Portuguese, mu=3)
EL_tTest <- t.test(bi_lang_pct$English_local, mu=2)
```
