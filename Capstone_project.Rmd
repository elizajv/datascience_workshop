This contains codes for my Data Science Workshop capstone project:

```{r}

## Load packages
library(jsonlite)
library(plyr)
library(stringr)
library(tidyr)
library(dplyr)
library(gdata)

## Extract data from Reliefweb API
"rwjobsraw1 <- fromJSON("http://api.reliefweb.int/v1/jobs?offset=9000&limit=1000&preset=analysis&fields[include][]title&fields[include][]=body&fields[include][]=theme&fields[include][]=country&fields[include][]=type&fields[include][]=experience&fields[include][]=career_categories&fields[include][]=date.created")

## Assign data set to "rwjobs1" and view dataset
rwjobs1 <- rwjobsraw1$data$fields
colnames(rwjobs1)
View(rwjobs1)

## Unlist nested lists
rwjobs1$theme <- llply(rwjobs1$theme, unlist)
rwjobs1$type <- llply(rwjobs1$type, unlist)
rwjobs1$experience <- llply(rwjobs1$experience, unlist)
rwjobs1$career_categories <- llply(rwjobs1$career_categories, unlist)
rwjobs1$country <- llply(rwjobs1$country, unlist)

## Clean dataset by removing unneccesary characters and splitting strings 
rwjobs1$type <- gsub("\\c\\(", "", rwjobs1$type)
rwjobs1$type <- gsub("\"", "", rwjobs1$type)
rwjobs1$type <- gsub("\\)", "", rwjobs1$type)
rwjobs1$type <- as.character(rwjobs1$type)
rwjobs1$type <- gsub("\\d+\\,", "", rwjobs1$type)

rwjobs1$experience <- gsub("\\c\\(", "", rwjobs1$experience)
rwjobs1$experience <- gsub("\"", "", rwjobs1$experience)
rwjobs1$experience <- gsub("\\years\\)", "", rwjobs1$experience)
rwjobs1$experience <- gsub("\\)", "", rwjobs1$experience)
experience_split <- strsplit(rwjobs1$experience, split = ",")
select_el <- function(x, index) {x[index]}
experience_id <- lapply(experience_split, select_el, index = 1) 
experience_years <- lapply(experience_split, select_el, index = 2) 
rwjobs1$experience_id <- as.character(experience_id)
rwjobs1$experience_years <- as.character(experience_years)
rwjobs1$experience_id <- NULL
rwjobs1$experience <- NULL

rwjobs1$country <- gsub("\\c\\(", "", rwjobs1$country)
rwjobs1$country <- gsub("\"", "", rwjobs1$country)
rwjobs1$country <- gsub("\\)", "", rwjobs1$country)
rwjobs1$country <- gsub('http\\S*\\s*', "", rwjobs1$country)
rwjobs1$country <- as.character(rwjobs1$country)
country_split <- strsplit(rwjobs1$country, split = ",")
select_el <- function(x, index) {x[index]}
country_name <- lapply(country_split, select_el, index = 4)
rwjobs1$country_name <- as.character(country_name)
rwjobs1$country <- rwjobs1$country_name
rwjobs1$country_name <- NULL

rwjobs1$career_categories <- gsub("\\c\\(", "", rwjobs1$career_categories)
rwjobs1$career_categories <- gsub("\"", "", rwjobs1$career_categories)
rwjobs1$career_categories <- gsub("\\)", "", rwjobs1$career_categories)
rwjobs1$career_categories <- as.character(rwjobs1$career_categories)
rwjobs1$career_categories <- gsub("\\d+\\,", "", rwjobs1$career_categories)

rwjobs1$theme <- gsub("\\c\\(", "", rwjobs1$theme)
rwjobs1$theme <- gsub("\"", "", rwjobs1$theme)
rwjobs1$theme <- gsub("\\)", "", rwjobs1$theme)
rwjobs1$theme <- gsub("\\d+\\,", "", rwjobs1$theme)

rwjobs1$date <- gsub("\\c\\(", "", rwjobs1$date)
rwjobs1$date <- gsub("\"", "", rwjobs1$date)
date_split <- strsplit(rwjobs1$date, split = "-")
select_el <- function(x, index) {x[index]}
year <- lapply(date_split, select_el, index = 1) 
month <- lapply(date_split, select_el, index = 2) 
day <- lapply(date_split, select_el, index = 3) 
rwjobs1$year <- as.character(year)
rwjobs1$month <- as.character(month)
rwjobs1$date <- NULL
rwjobs1$year[1]
rwjobs1$year[1000]
rwjobs1$month[1]
rwjobs1$month[1000]

## Save dataset into a csv file, amending the csv file name depending on the batch of data extracted
write.csv(rwjobs1, "rwjobs1.csv")

## Combine and view cleaned dataset
rwjobs1 <- read.csv("C:/Users/elizajv/Documents/rwjobs1.csv", 1)
rwjobs2 <- read.csv("C:/Users/elizajv/Documents/rwjobs2.csv", 1)
rwjobs3 <- read.csv("C:/Users/elizajv/Documents/rwjobs3.csv", 1)
rwjobs4 <- read.csv("C:/Users/elizajv/Documents/rwjobs4.csv", 1)
rwjobs5 <- read.csv("C:/Users/elizajv/Documents/rwjobs5.csv", 1)
rwjobs6 <- read.csv("C:/Users/elizajv/Documents/rwjobs6.csv", 1)
rwjobs7 <- read.csv("C:/Users/elizajv/Documents/rwjobs7.csv", 1)
rwjobs9 <- read.csv("C:/Users/elizajv/Documents/rwjobs9.csv", 1)
rwjobs10 <- read.csv("C:/Users/elizajv/Documents/rwjobs10.csv", 1)
rwjobs14 <- read.csv("C:/Users/elizajv/Documents/rwjobs14.csv", 1)
rwjobs20 <- read.csv("C:/Users/elizajv/Documents/rwjobs20.csv", 1)
rwjobs56 <- read.csv("C:/Users/elizajv/Documents/rwjobs56.csv", 1)
rwjobs69 <- read.csv("C:/Users/elizajv/Documents/rwjobs69.csv", 1)
rwjobs70 <- read.csv("C:/Users/elizajv/Documents/rwjobs70.csv", 1)
rwjobs124 <- read.csv("C:/Users/elizajv/Documents/rwjobs124.csv", 1)
rwjobs125 <- read.csv("C:/Users/elizajv/Documents/rwjobs125.csv", 1)
rwjobs126 <- read.csv("C:/Users/elizajv/Documents/rwjobs126.csv", 1)
rwjobs127 <- read.csv("C:/Users/elizajv/Documents/rwjobs127.csv", 1)
rwjobs2016 <- rbind(rwjobs1, rwjobs2, rwjobs3, rwjobs4, rwjobs5, rwjobs6, rwjobs7, rwjobs9, rwjobs10, rwjobs14, rwjobs20, rwjobs56, rwjobs69, rwjobs70, rwjobs124, rwjobs125, rwjobs126, rwjobs127)
View(rwjobs2016)
rwjobsall$X <- NULL

## Create columns for languages

## Create columns based on language keywords in the "body" and "country_name" columns, with the latter based on which donor countries have made English an official language
rwjobs2016$English1 <- as.vector(c(NA * 16799))
rwjobs2016$English1 <- str_match(rwjobs2016$body, "English")
rwjobs2016$English1 <- ifelse(rwjobs2016$English1 == "English", 1, 0)
rwjobs2016$English1 <- unmatrix(rwjobs2016$English1)

rwjobs2016$English2 <- as.vector(c(NA * 16799))
rwjobs2016$English2 <- str_match(rwjobs2016$country, "United States")
rwjobs2016$English2 <- ifelse(rwjobs2016$English2 == "United States", 1, 0)
rwjobs2016$English2 <- unmatrix(rwjobs2016$English2)
for (i in 1:length(rwjobs2016$English1))
if (!is.na(rwjobs2016$English1[i])) rwjobs2016$English2[i]=NA

rwjobs2016$English3 <- as.vector(c(NA * 16799))
rwjobs2016$English3 <- str_match(rwjobs2016$country, "United Kingdom")
rwjobs2016$English3 <- ifelse(rwjobs2016$English3 == "United Kingdom", 1, 0)
rwjobs2016$English3 <- unmatrix(rwjobs2016$English3)
for (i in 1:length(rwjobs2016$English1))
if (!is.na(rwjobs2016$English1[i])) rwjobs2016$English3[i]=NA

rwjobs2016$English4 <- as.vector(c(NA * 16799))
rwjobs2016$English4 <- str_match(rwjobs2016$country, "Ireland")
rwjobs2016$English4 <- ifelse(rwjobs2016$English4 == "Ireland", 1, 0)
rwjobs2016$English4 <- unmatrix(rwjobs2016$English4)
for (i in 1:length(rwjobs2016$English1))
if (!is.na(rwjobs2016$English1[i])) rwjobs2016$English4[i]=NA
for (i in 1:length(rwjobs2016$English3))
if (!is.na(rwjobs2016$English3[i])) rwjobs2016$English4[i]=NA

rwjobs2016$English5 <- as.vector(c(NA * 16799))
rwjobs2016$English5 <- str_match(rwjobs2016$country, "Canada")
rwjobs2016$English5 <- ifelse(rwjobs2016$English5 == "Canada", 1, 0)
rwjobs2016$English5 <- unmatrix(rwjobs2016$English5)
for (i in 1:length(rwjobs2016$English1))
if (!is.na(rwjobs2016$English1[i])) rwjobs2016$English5[i]=NA

rwjobs2016$English_total <- rowSums(rwjobs2016[, 11:16], na.rm = TRUE)

rwjobs2016$French <- as.vector(c(NA * 16799))
rwjobs2016$French <- str_match(rwjobs2016$body, "French")
rwjobs2016$French <- ifelse(rwjobs2016$French == "French", 1, 0)
rwjobs2016$French <- unmatrix(rwjobs2016$French)

rwjobs2016$Arabic <- as.vector(c(NA * 16799))
rwjobs2016$Arabic <- str_match(rwjobs2016$body, "Arabic") 
rwjobs2016$Arabic <- ifelse(rwjobs2016$Arabic=="Arabic", 1, 0)
rwjobs2016$Arabic <- unmatrix(rwjobs2016$Arabic)

rwjobs2016$Spanish <- as.vector(c(NA * 16799))
rwjobs2016$Spanish <- str_match(rwjobs2016$body, "Spanish") 
rwjobs2016$Spanish <- ifelse(rwjobs2016$Spanish=="Spanish", 1, 0)
rwjobs2016$Spanish <- unmatrix(rwjobs2016$Spanish)

rwjobs2016$Russian <- as.vector(c(NA * 16799))
rwjobs2016$Russian <- str_match(rwjobs2016$body, "Russian") 
rwjobs2016$Russian <- ifelse(rwjobs2016$Russian=="Russian", 1, 0)
rwjobs2016$Russian <- unmatrix(rwjobs2016$Russian)

rwjobs2016$Chinese <- as.vector(c(NA * 16799))
rwjobs2016$Chinese <- str_match(rwjobs2016$body, "Chinese") 
rwjobs2016$Chinese <- ifelse(rwjobs2016$Chinese=="Chinese", 1, 0)
rwjobs2016$Chinese <- unmatrix(rwjobs2016$Chinese)

rwjobs2016$Italian <- as.vector(c(NA * 16799))
rwjobs2016$Italian <- str_match(rwjobs2016$body, "Italian") 
rwjobs2016$Italian <- ifelse(rwjobs2016$Italian=="Italian", 1, 0)
rwjobs2016$Italian <- unmatrix(rwjobs2016$Italian)

rwjobs2016$Portuguese <- as.vector(c(NA * 16799))
rwjobs2016$Portuguese <- str_match(rwjobs2016$body, "Portuguese") 
rwjobs2016$Portuguese <- ifelse(rwjobs2016$Portuguese=="Portuguese", 1, 0)
rwjobs2016$Portuguese <- unmatrix(rwjobs2016$Portuguese)

rwjobs2016$local <- as.vector(c(NA * 16799))
rwjobs2016$local <- str_match(rwjobs2016$body, "local language") 
rwjobs2016$local <- ifelse(rwjobs2016$local=="local language", 1, 0)
rwjobs2016$local <- unmatrix(rwjobs2016$local)

rwjobs2016$Swahili <- as.vector(c(NA * 16799))
rwjobs2016$Swahili <- str_match(rwjobs2016$body, "Swahili") 
rwjobs2016$Swahili <- ifelse(rwjobs2016$Swahili=="Swahili", 1, 0)
rwjobs2016$Swahili <- unmatrix(rwjobs2016$Swahili)

rwjobs2016$Urdu <- as.vector(c(NA * 16799))
rwjobs2016$Urdu <- str_match(rwjobs2016$body, "Urdu") 
rwjobs2016$Urdu <- ifelse(rwjobs2016$Urdu=="Urdu", 1, 0)
rwjobs2016$Urdu <- unmatrix(rwjobs2016$Urdu)

rwjobs2016$Bahasa <- as.vector(c(NA * 16799))
rwjobs2016$Bahasa <- str_match(rwjobs2016$body, "Bahasa") 
rwjobs2016$Bahasa <- ifelse(rwjobs2016$Bahasa=="Bahasa", 1, 0)
rwjobs2016$Bahasa <- unmatrix(rwjobs2016$Bahasa)

rwjobs2016$Hindi <- as.vector(c(NA * 16799))
rwjobs2016$Hindi <- str_match(rwjobs2016$body, "Hindi") 
rwjobs2016$Hindi <- ifelse(rwjobs2016$Hindi=="Hindi", 1, 0)
rwjobs2016$Hindi <- unmatrix(rwjobs2016$Hindi)

rwjobs2016$language_total <- rowSums(rwjobs2016[, 17:29], na.rm = TRUE)

## Reassign dataset
rwjobs2016fl <- filter(rwjobs2016, English_total == 1)
View(rwjobs2016fl)

## Create columns indicating fluency and/or working knowledge in English and another language 
rwjobs2016fl$EF <- rwjobs2016fl$English_total + rwjobs2016fl$French
rwjobs2016fl$EA <- rwjobs2016fl$English_total + rwjobs2016fl$Arabic
rwjobs2016fl$ES <- rwjobs2016fl$English_total + rwjobs2016fl$Spanish
rwjobs2016fl$ER <- rwjobs2016fl$English_total + rwjobs2016fl$Russian
rwjobs2016fl$EC <- rwjobs2016fl$English_total + rwjobs2016fl$Chinese
rwjobs2016fl$EI <- rwjobs2016fl$English_total + rwjobs2016fl$Italian
rwjobs2016fl$EP <- rwjobs2016fl$English_total + rwjobs2016fl$Portuguese
rwjobs2016fl$EL <- rwjobs2016fl$English_total + rwjobs2016fl$local
rwjobs2016fl$ESw <- rwjobs2016fl$English_total + rwjobs2016fl$Swahili
rwjobs2016fl$EU <- rwjobs2016fl$English_total + rwjobs2016fl$Urdu
rwjobs2016fl$EB <- rwjobs2016fl$English_total + rwjobs2016fl$Bahasa
rwjobs2016fl$EH <- rwjobs2016fl$English_total + rwjobs2016fl$Hindi

## Determine bilingual frequencies
## Determine overall bilingual frequencies
total_EF <- sum(rwjobs2016fl$EF, na.rm = TRUE) / 2
EF_percent <- total_EF / nrow(rwjobs2016fl)

total_EA <- sum(rwjobs2016fl$EA, na.rm = TRUE) / 2 
EA_percent <- total_EA / nrow(rwjobs2016fl)

total_ES <- sum(rwjobs2016fl$ES, na.rm = TRUE) / 2 
ES_percent <- total_ES / nrow(rwjobs2016fl)

total_ER <- sum(rwjobs2016fl$ER, na.rm = TRUE) / 2 
ER_percent <- total_ER / nrow(rwjobs2016fl)

total_EC <- sum(rwjobs2016fl$EC, na.rm = TRUE) / 2 
EC_percent <- total_EC / nrow(rwjobs2016fl)

total_EI <- sum(rwjobs2016fl$EI, na.rm = TRUE) / 2 
EI_percent <- total_EI / nrow(rwjobs2016fl)

total_EP <- sum(rwjobs2016fl$EP, na.rm = TRUE) / 2 
EP_percent <- total_EP / nrow(rwjobs2016fl)

total_EL <- sum(rwjobs2016fl$EL, na.rm = TRUE) / 2 
EL_percent <- total_EL / nrow(rwjobs2016fl)

total_ESw <- sum(rwjobs2016fl$ESw, na.rm = TRUE) / 2 
ESw_percent <- total_ESw / nrow(rwjobs2016fl)

total_EU <- sum(rwjobs2016fl$EU, na.rm = TRUE) / 2 
EU_percent <- total_EU / nrow(rwjobs2016fl)

total_EB <- sum(rwjobs2016fl$EB, na.rm = TRUE) / 2 
EB_percent <- total_EB / nrow(rwjobs2016fl)

total_EH <- sum(rwjobs2016fl$EH, na.rm = TRUE) / 2 
EH_percent <- total_EH / nrow(rwjobs2016fl)

total_bilingual <- sum(total_EA, total_EF, total_ES, total_ER, total_EC, total_EI, total_EP, total_EL, total_ESw, total_EU, total_EB, total_EH)

total_bilingual_percent <- total_bilingual / nrow(rwjobs2016fl)
